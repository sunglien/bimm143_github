<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>PIANO 40‑Second Drill</title>
  <!-- Tailwind (CDN play) -->
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    html, body { height: 100%; }
    .blurry { filter: blur(6px); }
  </style>
  <!-- React 18 + Babel (CDN) -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>
<body class="min-h-full bg-slate-50 text-slate-900">
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect } = React;

    // --- Helpers ---
    const pad2 = (n) => String(n).padStart(2, '0');
    const shuffleArray = (arr) => {
      const a = arr.slice();
      for (let i = a.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [a[i], a[j]] = [a[j], a[i]];
      }
      return a;
    };

    // --- DATA (from your list) ---
    const defaultData = [
      { name: 'Gluteus Maximus', origin: 'Ilium, sacrum, coccyx, sacrotuberous ligament', insertion: 'Gluteal tuberosity, iliotibial tract (IT Band)', actions: 'Hip ER, EXT', innervation: 'VR L5-S2 Inferior gluteal n.', perfusion: 'Superior + Inferior gluteal aa/vv.' },
      { name: 'Gluteus Medius', origin: 'Anterior and Posterior gluteal lines (Ilium)', insertion: 'Greater trochanter', actions: 'Hip IR, ABD + Hip stabilization', innervation: 'VR L4-S1 Superior gluteal n.', perfusion: 'Superior gluteal aa/vv.' },
      { name: 'Gluteus Minimus', origin: 'Anterior and Inferior gluteal lines (Ilium)', insertion: 'Greater trochanter', actions: 'Hip IR, ABD + Hip stabilization', innervation: 'VR L4-S1 Superior gluteal n.', perfusion: 'Superior gluteal aa/vv.' },
      { name: 'Piriformis', origin: 'Anterior surface of sacrum, Sacrotuberous ligament', insertion: 'Greater trochanter (upper end)', actions: 'Hip ER', innervation: 'VR S1-S2 n. to piriformis mm.', perfusion: 'Superior + Inferior gluteal aa/vv.' },
      { name: 'Superior Gemellus', origin: 'Ischial Spine', insertion: 'Greater trochanter (via obturator internus tendon)', actions: 'Hip ER', innervation: 'VR L5-S2 n. to superior gemellus and obturator internus mm.', perfusion: 'Inferior Gluteal aa/vv' },
      { name: 'Obturator Internus', origin: 'Ischiopubic ramus, Obturator membrane', insertion: 'Greater trochanter', actions: 'Hip ER, ABD', innervation: 'VR L5-S2 n. to superior gemellus and obturator internus mm.', perfusion: 'Inferior Gluteal aa/vv' },
      { name: 'Inferior Gemellus', origin: 'Ischial tuberosity', insertion: 'Greater trochanter (via obturator internus tendon)', actions: 'Hip ER', innervation: 'VR L4-S1 n. to inferior gemellus and Quadratus Femoris mm.', perfusion: 'Inferior Gluteal aa/vv' },
      { name: 'Quadratus Femoris', origin: 'Ischial tuberosity', insertion: 'Intertrochanteric crest', actions: 'Hip ER', innervation: 'VR L4-S1 n. to inferior gemellus and Quadratus Femoris mm.', perfusion: 'Inferior Gluteal aa/vv' },
      { name: 'Psoas Major', origin: 'Transverse process (TP), Intervertebral Disks (IVD) and Bodies of T12-L5', insertion: 'Lesser Trochanter', actions: 'Hip FLX, Trunk FLX', innervation: 'VR T12 Subcostal n. + L1-L3 spinal n.', perfusion: 'Now: Abdominal Aorta; Later: 12th Anterior Intercostal aa/vv.; #1-3 Lumbar aa/vv.' },
      { name: 'Psoas Minor', origin: 'Intervertebral Disks (IVD), and bodies of T12-L1', insertion: 'Lesser Trochanter', actions: 'aids in Trunk FLX', innervation: 'VR T12 Subcostal n. + L1 spinal n.', perfusion: 'Now: Abdominal Aorta; Later: 12th Anterior Intercostal aa/vv.; #1-3 Lumbar aa/vv.' },
      { name: 'Iliacus', origin: 'Iliac fossa, Ala of sacrum, TP, IVD, and bodies of T12-L5', insertion: 'Lesser Trochanter', actions: 'Hip FLX', innervation: 'VR L2-L4 femoral n.', perfusion: 'External Iliac aa/vv.' },
      { name: 'Iliopsoas', origin: 'Iliac fossa, Ala of sacrum, TP, IVD, and bodies of T12-L5', insertion: 'Lesser Trochanter', actions: 'Hip FLX', innervation: 'VR L2-L4 femoral n.', perfusion: 'Femoral aa/vv.' },
      { name: 'Sartorius', origin: 'ASIS', insertion: 'Pes Anserine (medial tibia)', actions: 'Hip FLX, ER, ABD + Leg IR, FLX', innervation: 'VR L2-L4 femoral n.', perfusion: 'Femoral aa/vv.' },
      { name: 'Rectus Femoris', origin: 'AIIS, posterior-superior rim of acetabulum', insertion: 'base of patella, tibial tuberosity', actions: 'Hip FLX, and leg EXT', innervation: 'VR L2-L4 femoral n.', perfusion: 'Femoral aa/vv.' },
      { name: 'Vastus Medialis', origin: 'Intertrochanteric line, linea aspera, medial intermuscular septum', insertion: 'medial side of patella, tibial tuberosity', actions: 'Leg EXT', innervation: 'VR L2-L4 femoral n.', perfusion: 'Femoral aa/vv.' },
      { name: 'Vastus Lateralis', origin: 'Intertrochanteric line, linea aspera, lateral intermuscular septum, greater trochanter, gluteal tuberosity', insertion: 'lateral side of patella, tibial tuberosity', actions: 'Leg EXT', innervation: 'VR L2-L4 femoral n.', perfusion: 'Femoral aa/vv.' },
      { name: 'Vastus Intermedius', origin: 'upper shaft of femur, lower lateral intermuscular septum', insertion: 'upper border of patella, tibial tubeosity', actions: 'Leg EXT', innervation: 'VR L2-L4 femoral n.', perfusion: 'Femoral aa/vv.' },
      { name: 'Articularis Genu', origin: 'Distal Femur (Anterior portion)', insertion: 'suprapatellar bursa', actions: 'Pulls suprapatellar tendon superiorly', innervation: 'VR L2-L4 femoral n.', perfusion: 'Femoral aa/vv.' },
      { name: 'Pectineus', origin: 'pectineal line of pubis bone', insertion: 'pectineal line of femur bone', actions: 'Hip FLX, ADD', innervation: 'VR L2-L4 femoral n. + VR L2-L4 obturator n.', perfusion: 'Femoral aa/vv. + Obturator aa/vv.' },
      { name: 'Adductor Magnus', origin: 'Ischial tuberosity, Ischiopubic ramus', insertion: 'Adductor tubercle, Linea Aspera, Medial supracondylar line of femur (ATLAS)', actions: 'Hip ADD, EXT, FLX', innervation: 'VR L2-L4 Obturator n. + VR L4-S3 tibial division of sciatic n.', perfusion: 'Obturator aa/vv. + Profundus femoris aa/vv.' },
      { name: 'Adductor Longus', origin: 'Body of Pubis', insertion: 'Linea Aspera', actions: 'Hip ADD, FLX', innervation: 'VR L2-L4 Obturator n.', perfusion: 'Obturator aa/vv.' },
      { name: 'Adductor Brevis', origin: 'Body of Pubis', insertion: 'pectineal line of femur, linea aspera', actions: 'Hip ADD, FLX', innervation: 'VR L2-L4 Obturator n.', perfusion: 'Obturator aa/vv.' },
      { name: 'Gracilis', origin: 'Body of Pubis', insertion: 'Pes Anserine (medial tibia)', actions: 'Hip ADD, FLX + Leg FLX, IR', innervation: 'VR L2-L4 Obturator n.', perfusion: 'Obturator aa/vv.' },
      { name: 'Obturator Externus', origin: 'margin of obturator foramen and obturator membrane', insertion: 'intertrochanteric fossa of femur', actions: 'Hip ER', innervation: 'VR L2-L4 Obturator n.', perfusion: 'Obturator aa/vv.' },
      { name: 'Tensor Fascia Latae (TFL)', origin: 'ASIS
iliac spine', insertion: 'iliotibial tract (IT Band)', actions: 'Hip FLX, IR, ABD + (Hip stabilization)', innervation: 'VR L4-S1 Superior gluteal n.', perfusion: 'Superior gluteal aa/vv.' },
      { name: 'Semitendinosus', origin: 'Ischial tuberosity', insertion: 'Pes Anserine (medial tibia)', actions: 'Hip EXT + Leg FLX, IR', innervation: 'VR L4-S3 Tibial division of Sciatic n.', perfusion: 'Profundus femoris aa/vv.' },
      { name: 'Semimembranosus', origin: 'Ischial tuberosity', insertion: 'Medial condyle of tibia', actions: 'Hip EXT + Leg FLX, IR', innervation: 'VR L4-S3 Tibial division of Sciatic n.', perfusion: 'Profundus femoris aa/vv.' },
      { name: 'Biceps Femoris (Long head)', origin: 'Ischial tuberosity', insertion: 'head of fibula', actions: 'Hip EXT + Leg FLX, ER', innervation: 'VR L4-S3 Tibial division of Sciatic n.', perfusion: 'Profundus femoris aa/vv.' },
      { name: 'Biceps Femoris (Short Head)', origin: 'Linea Aspera
Lateral Supracondylar line of Femur', insertion: 'head of fibula', actions: 'Leg FLX , ER', innervation: 'VR L4-S3 Common Fibular division of Sciatic n.', perfusion: 'Profundus femoris aa/vv.' }
    ];

    const App = () => {
      const [cards, setCards] = useState(defaultData);
      const [index, setIndex] = useState(0);
      const [duration, setDuration] = useState(() => {
        const saved = Number(localStorage.getItem('pianoDrillDuration'));
        return Number.isFinite(saved) && saved >= 5 ? saved : 40;
      });
      const [secondsLeft, setSecondsLeft] = useState(duration);
      const [running, setRunning] = useState(false);
      const [revealed, setRevealed] = useState(false);
      const [shuffle, setShuffle] = useState(false);
      const [autoStart, setAutoStart] = useState(true);

      const current = cards[index] || {};

      useEffect(() => { localStorage.setItem('pianoDrillDuration', String(duration)); }, [duration]);

      useEffect(() => {
        let id;
        if (running) {
          id = setInterval(() => {
            setSecondsLeft((s) => {
              if (s <= 1) {
                clearInterval(id);
                setRunning(false);
                setRevealed(true);
                return 0;
              }
              return s - 1;
            });
          }, 1000);
        }
        return () => clearInterval(id);
      }, [running]);

      useEffect(() => {
        setSecondsLeft(duration);
        setRevealed(false);
        if (autoStart) setRunning(true); else setRunning(false);
      }, [duration, index]);

      const next = () => setIndex((i) => (i + 1) % cards.length);
      const prev = () => setIndex((i) => (i - 1 + cards.length) % cards.length);

      const onShuffleToggle = () => {
        if (!shuffle) {
          const newOrder = shuffleArray(cards);
          setCards(newOrder);
          setIndex(0);
        }
        setShuffle((v) => !v);
      };

      const resetTimer = () => { setSecondsLeft(duration); setRunning(false); setRevealed(false); };
      const revealNow = () => { setRevealed(true); setRunning(false); };

      const minutes = Math.floor(secondsLeft / 60);
      const seconds = secondsLeft % 60;

      const PIANO = [
        { key: 'P', label: 'Perfusion', value: current.perfusion },
        { key: 'I', label: 'Innervation', value: current.innervation },
        { key: 'A', label: 'Actions', value: current.actions },
        { key: 'N', label: 'Nerve Roots / Notes', value: current.innervation },
        { key: 'O', label: 'Attachments (Origin / Insertion)', value: `O: ${current.origin || ''}
I: ${current.insertion || ''}` },
      ];

      return (
        <div className="max-w-5xl mx-auto p-4 sm:p-6">
          <header className="flex flex-col sm:flex-row sm:items-end gap-3 justify-between mb-4">
            <div>
              <h1 className="text-2xl sm:text-3xl font-bold tracking-tight">PIANO 40‑Second Drill</h1>
              <p className="text-sm text-slate-600">Prompt shows a muscle name. Answers (P·I·A·N·O) auto‑reveal when the timer hits zero.</p>
            </div>
            <div className="flex items-center gap-2 text-slate-700">
              <span className="text-xs">Card</span>
              <span className="font-semibold">{cards.length ? index + 1 : 0}</span>
              <span className="text-xs">/</span>
              <span className="font-semibold">{cards.length}</span>
            </div>
          </header>

          {/* Controls */}
          <section className="grid gap-4 sm:grid-cols-3 mb-6">
            <div className="bg-white rounded-2xl shadow p-4 flex flex-col items-center justify-center">
              <div className="text-5xl font-bold tabular-nums">{pad2(minutes)}:{pad2(seconds)}</div>
              <div className="mt-3 flex gap-2">
                <button onClick={() => setRunning((r) => !r)} className="px-4 py-2 rounded-xl bg-slate-900 text-white hover:opacity-90">{running ? 'Pause' : 'Start'}</button>
                <button onClick={resetTimer} className="px-4 py-2 rounded-xl bg-slate-200 hover:bg-slate-300">Reset</button>
                <button onClick={revealNow} className="px-4 py-2 rounded-xl bg-emerald-600 text-white hover:opacity-90">Reveal</button>
              </div>
              <p className="mt-1 text-xs text-slate-500">Space: Start/Pause · R: Reveal · ←/→: Prev/Next</p>
            </div>

            <div className="bg-white rounded-2xl shadow p-4">
              <label className="text-sm font-medium">Countdown length: <span className="font-semibold">{duration}s</span></label>
              <input type="range" min="10" max="120" step="5" value={duration} onChange={(e) => setDuration(Number(e.target.value))} className="w-full mt-2" />
              <label className="mt-3 flex items-center gap-2 text-sm">
                <input type="checkbox" checked={autoStart} onChange={(e) => setAutoStart(e.target.checked)} />
                Auto‑start timer on Next
              </label>
            </div>

            <div className="bg-white rounded-2xl shadow p-4 flex flex-col gap-2">
              <div className="flex gap-2">
                <button onClick={prev} className="px-4 py-2 rounded-xl bg-slate-200 hover:bg-slate-300 w-full">Prev</button>
                <button onClick={next} className="px-4 py-2 rounded-xl bg-slate-900 text-white hover:opacity-90 w-full">Next</button>
              </div>
              <button onClick={onShuffleToggle} className={`px-4 py-2 rounded-xl w-full ${shuffle ? 'bg-indigo-600 text-white' : 'bg-slate-200 hover:bg-slate-300'}`}>{shuffle ? 'Shuffling On' : 'Shuffle Order'}</button>
            </div>
          </section>

          {/* Card */}
          <section className="bg-white rounded-3xl shadow p-6">
            <div className="flex flex-col md:flex-row gap-6">
              {/* Prompt */}
              <div className="md:w-1/3">
                <div className="rounded-2xl border border-slate-200 p-5 h-full flex flex-col justify-between">
                  <div>
                    <p className="text-xs uppercase tracking-widest text-slate-500">Prompt</p>
                    <h2 className="mt-1 text-2xl font-semibold">{current.name || '—'}</h2>
                  </div>
                  <div className="mt-4 text-xs text-slate-500">Study the prompt. Answers will reveal automatically at 0.</div>
                </div>
              </div>

              {/* Answers */}
              <div className="md:w-2/3">
                <div className="rounded-2xl border border-slate-200 p-5">
                  <p className="text-xs uppercase tracking-widest text-slate-500 mb-2">Answers (P·I·A·N·O)</p>
                  <div className={!revealed ? 'blurry select-none pointer-events-none' : ''}>
                    <dl className="grid grid-cols-1 sm:grid-cols-2 gap-3">
                      {PIANO.map((row) => (
                        <div key={row.key} className="bg-slate-50 rounded-xl p-3 border border-slate-100">
                          <dt className="text-xs font-semibold text-slate-500">{row.label}</dt>
                          <dd className="mt-1 text-sm whitespace-pre-line">{row.value || '—'}</dd>
                        </div>
                      ))}
                    </dl>
                  </div>

                  {!revealed && (
                    <div className="mt-4">
                      <button onClick={revealNow} className="px-4 py-2 rounded-xl bg-emerald-600 text-white hover:opacity-90">Reveal now</button>
                    </div>
                  )}
                </div>
              </div>
            </div>
          </section>

          <footer className="mt-6 text-xs text-slate-500 text-center">
            <p>Single‑file app for quick anatomy drills. Host anywhere (e.g., GitHub Pages).</p>
          </footer>
        </div>
      );
    };

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<App />);
  </script>
</body>
</html>
